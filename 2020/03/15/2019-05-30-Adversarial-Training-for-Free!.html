<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2019-05-30-Adversarial-Training-for-Free!.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Motivations : </span>
<span class="o">-</span> <span class="n">the</span> <span class="n">high</span> <span class="n">cost</span> <span class="n">of</span> <span class="n">generating</span> <span class="n">strong</span> <span class="n">adversarial</span> <span class="n">examples</span> <span class="n">makes</span> <span class="n">standard</span> <span class="n">adversarial</span> <span class="n">training</span> <span class="n">impractical</span> <span class="n">on</span> <span class="n">large</span><span class="o">-</span><span class="n">scale</span> <span class="n">problems</span> <span class="n">like</span> <span class="n">ImageNet</span>
<span class="o">-</span> <span class="n">Adversarial</span> <span class="n">training</span> <span class="ow">is</span> <span class="n">time</span><span class="o">-</span><span class="n">consuming</span><span class="err">â€”</span><span class="ow">in</span> <span class="n">addition</span> <span class="n">to</span> <span class="n">the</span> <span class="n">gradient</span> <span class="n">computation</span> <span class="n">needed</span> <span class="n">to</span> <span class="n">update</span> <span class="n">the</span> <span class="n">network</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">each</span> <span class="n">stochastic</span> <span class="n">gradient</span> <span class="n">descent</span> <span class="p">(</span><span class="n">SGD</span><span class="p">)</span> <span class="n">iteration</span> <span class="n">requires</span> <span class="n">multiple</span> <span class="n">gradient</span>
<span class="n">computations</span> <span class="n">to</span> <span class="n">produce</span> <span class="n">adversarial</span> <span class="n">images</span><span class="o">.</span>
<span class="n">Put</span> <span class="n">simply</span><span class="p">,</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">slowdown</span> <span class="n">factor</span> <span class="n">depends</span> <span class="n">on</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">gradient</span> <span class="n">steps</span> <span class="n">used</span> <span class="k">for</span> <span class="n">adversarial</span> <span class="n">example</span> <span class="n">generation</span><span class="o">.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Objective-:-To-perform-Adversarial-training-with-very-little-overhead-and-avoid-re-computation-as-much-as-possible.">Objective : To perform Adversarial training with very little overhead and avoid re computation as much as possible.<a class="anchor-link" href="#Objective-:-To-perform-Adversarial-training-with-very-little-overhead-and-avoid-re-computation-as-much-as-possible."> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Idea:-(Generation-of-Adversarial-samples-by-recycling--the-gradients-information-computed-when-updating-the-model-parameters">Idea: (Generation of Adversarial samples by recycling  the gradients information computed when updating the model parameters<a class="anchor-link" href="#Idea:-(Generation-of-Adversarial-samples-by-recycling--the-gradients-information-computed-when-updating-the-model-parameters"> </a></h2>
<pre><code>- The Key idea is to update both the model parameters and image perturbations using one simultaneous backward pass, rather than using separate gradient computations for each update
- </code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Other-Equivalent-Approaches:">Other Equivalent Approaches:<a class="anchor-link" href="#Other-Equivalent-Approaches:"> </a></h2><p>Replace the perturbation generation step in Adversarial Training with Parameterized Generator network. (Caveat : GANs find it hard to produce Highly diverse/expressive results )</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Minimal-Example-to-Replicate-the-paper:">Minimal Example to Replicate the paper:<a class="anchor-link" href="#Minimal-Example-to-Replicate-the-paper:"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CIFAR-10">CIFAR-10<a class="anchor-link" href="#CIFAR-10"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="imports">imports<a class="anchor-link" href="#imports"> </a></h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="kn">import</span> <span class="n">CIFAR10</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Setup-Dataset-and-Dataloaders">Setup Dataset and Dataloaders<a class="anchor-link" href="#Setup-Dataset-and-Dataloaders"> </a></h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_ds</span> <span class="o">=</span> <span class="n">CIFAR10</span><span class="p">(</span><span class="s1">&#39;~/.torch/datasets&#39;</span><span class="p">,</span><span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">CIFAR10</span><span class="p">(</span><span class="s1">&#39;~/.torch/datasets&#39;</span><span class="p">,</span><span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">train_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">test_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">test_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Files already downloaded and verified
Files already downloaded and verified
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CIFAR-100">CIFAR-100<a class="anchor-link" href="#CIFAR-100"> </a></h3>
</div>
</div>
</div>
</div>

